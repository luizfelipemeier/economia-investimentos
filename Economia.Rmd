---
title: "DADOS DA ECONOMIA BRASILEIRA"
output: 
  bookdown::html_document2:
    theme: readable
    split_by: "section"
    fig_width: 7
    fig_height: 6
    fig_caption: true
    number_sections: false 
    toc: yes
    toc_depth: 3
    toc_float:
        collapsed: no
        smooth_scroll: yes
date: "Atualizado em `r Sys.setlocale('LC_TIME', 'Portuguese_Brazil') ; format(Sys.time(), format = '%d de %B de %Y')`"
---
<!-- Inclua a biblioteca Font Awesome -->
<script src="https://kit.fontawesome.com/4e10600d5e.js" crossorigin="anonymous"></script>

<!-- Configuração do corpo do site -->
<style>
  body {
    text-align: justify;
    line-height: 1.5;
    background-color: #f4f4f4;
  }

/* Estilos para telas menores que 600 pixels de largura */
@media only screen and (max-width: 600px) {
  body {
    margin-left: 0; /* Remove o recuo na margem esquerda para telas menores */
    font-size: 2rem;
  }
}

  h1 {
    color: #0066cc; /* Azul para títulos de nível 1 */
    font-size: 4rem;
  }

  h2 {
    color: #3399ff; /* Azul claro para títulos de nível 2 */
    font-size: 2rem;
  }

  h3 {
    color: #66b2ff; /* Azul ainda mais claro para títulos de nível 3 */
    font-size: 2rem;
  }

  p {
    color: #333333; /* Cor padrão para texto */
    font-size: 2rem;
  }

</style>


<style>
  .dual-frames {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
  }

  .frame {
    width: 48%;
    border: 0.2rem solid #ddd;
    padding: 0.8rem;
    box-sizing: border-box;
    font-size: 1rem; /* Exemplo de tamanho de fonte para os quadros usando unidades relativas */

    /* Adicione uma margem inferior para espaçamento entre os quadros */
    margin-bottom: 1em;
  }

  /* Estilos para telas menores que 600 pixels de largura */
  @media only screen and (max-width: 600px) {
    .frame {
      width: 100%;
    }
  }
</style>


```{r include=FALSE}

#carregando pacotes
library(bookdown)
library(sidrar)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(lubridate)
library(knitr)
library(kableExtra)
library(DT)
library(forcats)
library(plotly)
library(highcharter)
library(GetBCBData)

```

# BRASIL

Dados referentes a economia brasileira. Dados para auxiliar a entender a conjuntura econômica do nosso país.


## PRODUTO 

As métricas de produto buscam mensurar quantidade de riqueza gerada em um país, estado ou cidade, dentro de um período de tempo.

### Produto Interno Bruto

O Produto Interno Bruto (PIB - *GDP/Gross Domestic Product*) é a soma de todos os bens e serviços finais produzidos por um país, estado ou cidade, geralmente em um ano.
<style>
  .spacer {
    height: 2rem; /* Ajuste conforme necessário para o tamanho desejado */
  }
</style>

<div class="spacer"></div>
<div class="dual-frames">
<div class="frame">
*The Organisation for Economic Co-operation and Development ([OECD](https://en.wikipedia.org/wiki/OECD)) defines GDP as "an aggregate measure of production equal to the sum of the gross values added of all resident and institutional units engaged in production and services (plus any taxes, and minus any subsidies, on products not included in the value of their outputs)"*
</div>
<div class="frame">
*An [IMF](https://en.wikipedia.org/wiki/International_Monetary_Fund) publication states that, "GDP measures the monetary value of final goods and services—that are bought by the final user—produced in a country in a given period (say a quarter or a year)."*
</div>
</div>
<style>
  .spacer {
    height: 2rem; /* Ajuste conforme necessário para o tamanho desejado */
  }
</style>

<div class="spacer"></div>

Existem três metodologias de cálculo do PIB, sendo que teoricamente todas elas chegam ao mesmo valor final.

<style>
  .spacer {
    height: 2rem; /* Ajuste conforme necessário para o tamanho desejado */
  }
</style>

<div class="spacer"></div>

**Ótica da oferta ou produção**

Também conhecida como *método do valor adicionado*, calcula o montante que cada estágio da produção agrega ao produto. Primeiro estima-se o do *valor adicionado bruto* fabricado das diversas atividades econômicas.Posteriormente estima-se o valor do *consumo intermediário*, onde considera os custos dos bens e serviços utilizados para produzir os bens e serviços finais. Ademais, subtrai o valor doméstico bruto do valor intermediário. Por fim, *subtrai os valores dos impostos indiretos e soma os valores dos subsídios*. 

<style>
  .spacer {
    height: 2rem; /* Ajuste conforme necessário para o tamanho desejado */
  }
</style>

<div class="spacer"></div>

**Ótica da renda**

O método inicia com o somatório dos *salários, vencimentos e rendimentos* recebidos pelas atividades laborais, *juros e receitas* advindos de diversos investimentos, *aluguéis* referentes aos alugueis/arrendamentos de imóveis ou terras, *lucros corporativos* oriundos dos lucros das empresas e *lucros líquidos* das transferências dos lucros das empresas para as pessoas.
Este somatório resulta no rendimento doméstico líquido dos custos dos fatores.
Para chegar ao PIB, deve-se ainda considerar a *deprecisação do capital*, as *taxas de produção e importação* e os *subsídios* estatais. 

<style>
  .spacer {
    height: 2rem; /* Ajuste conforme necessário para o tamanho desejado */
  }
</style>

<div class="spacer"></div>

**Ótica do consumo**

teste

<style>
  .spacer {
    height: 2rem; /* Ajuste conforme necessário para o tamanho desejado */
  }
</style>

<div class="spacer"></div>
```{r echo=FALSE, warning=FALSE, message=FALSE}

df.bcb <- gbcbd_get_series(id = 4192 ,
                       first.date = '2000-01-01',
                       last.date = Sys.Date(),
                       format.data = 'long',
                       use.memoise = TRUE, 
                       cache.path = tempdir(), # use tempdir for cache folder
                       do.parallel = FALSE)
```


### PIB per capita


## MOEDA 

### Inflação {.tabset .tabset-fade .tabset-pills}

É o aumento generalizado e persistente do nível de preços de uma economia.

**Causas da inflação**

A inflação pode ter várias causas, que podem ser agrupadas em:

- Pressões de demanda
- Pressões de custos
- Inércia inflacionária
- Expectativas de inflação

**Consequências da inflação**

A inflação descontrolada gera incertezas importantes na economia, desestimulando o investimento e, assim, prejudicando o crescimento econômico. Os preços relativos ficam distorcidos, gerando várias ineficiências na economia. As pessoas e as firmas perdem noção dos preços relativos e, assim, fica difícil avaliar se algo está barato ou caro. A inflação afeta particularmente as camadas menos favorecidas da população, pois essas têm menos acesso a instrumentos financeiros para se defender da inflação.

Inflação mais alta também aumenta o custo da dívida pública, pois as taxas de juros da dívida pública têm de compensar não só o efeito da inflação mas também têm de incluir um prêmio de risco para compensar as incertezas associadas com a inflação mais alta.

**Por que a deflação é também indesejável?**

O Banco Central trabalha para manter a inflação baixa – não para que os preços declinem. A perspectiva de que os valores cobrados sejam relativamente estáveis ao longo do tempo, com inflação baixa e previsível, é importante para o planejamento de todos. Ao contrário do que possa parecer, preços em queda podem ser prejudiciais para o bom funcionamento da economia. Um comerciante poderá ter prejuízo se ganhar menos amanhã pelo estoque que fez hoje. As famílias e as empresas poderão adiar suas decisões de consumo e investimento se houver a perspectiva de que os preços serão mais baixos amanhã, deprimindo a atividade econômica.

#### IPCA {.tabset .tabset-fade .tabset-pills}

O IPCA mede a variação de preços de uma cesta de produtos e serviços consumida pela população. O resultado mostra se os preços aumentaram ou diminuíram de um mês para o outro.

A cesta é definida pela [Pesquisa de Orçamentos Familiares](https://www.ibge.gov.br/estatisticas/sociais/populacao/24786-pesquisa-de-orcamentos-familiares-2.html?utm_source=landing&utm_medium=explica&utm_campaign=inflacao) - POF, do IBGE, que, entre outras questões, verifica o que a população consome e quanto do rendimento familiar é gasto em cada produto: arroz, feijão, passagem de ônibus, material escolar, médico, cinema, entre outros.

O índice, portanto, leva em conta não apenas a variação de preço de cada item, mas também o peso que ele tem no orçamento das famílias.

Atualmente, a população-objetivo do IPCA abrange as famílias<span style="font-weight: bold; color: #ff6600;"> com rendimentos de 1 a 40 salários mínimos</span>, qualquer que seja a fonte, residentes nas áreas urbanas das regiões de abrangência do SNIPC, as quais são: regiões metropolitanas de Belém, Fortaleza, Recife, Salvador, Belo Horizonte, Vitória, Rio de Janeiro, São Paulo, Curitiba, Porto Alegre, além do Distrito Federal e dos municípios de Goiânia, Campo Grande, Rio Branco, São Luís e Aracaju.

##### Índice {.tabset .tabset-fade .tabset-pills}

[Tabela 1337](https://sidra.ibge.gov.br/tabela/1737)

```{r echo=FALSE, warning=FALSE, message=FALSE}

sidra <- function(z, y)
{
  get_sidra(api = z) %>% 
    select(`Mês (Código)`, `Valor`, `Variável`) %>% 
    mutate(Data = as.Date(paste0(`Mês (Código)`, "01"), format = "%Y%m%d")) %>% 
    select(Data, Valor, `Variável`) %>% 
    mutate(Data = format(Data, "%Y-%m")) %>% 
    filter(Data >= y) 
    }

IPCA <- sidra('/t/1737/n1/all/v/63,2263,2264,2265/p/all/d/v63%202,v2263%202,v2264%202,v2265%202', format(Sys.Date() - months(120), "%Y-%m")) %>% 
  pivot_wider(names_from = "Variável", values_from = "Valor")

IPCA <- arrange(IPCA, desc(Data))
colnames(IPCA) <- c("Data", "Mensal", "3 meses", "6 meses", "12 meses")

datatable(IPCA, options = list(pageLength = 10, autoWidth = TRUE, columnDefs = list(list(className = 'dt-center', targets = '_all'))), caption = "VARIAÇÃO MENSAL E ACUMULADA")


```

###### Mensal

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}

sidra <- function(z, y) {
  get_sidra(api = z) %>% 
    select(`Mês (Código)`, `Valor`, `Variável`) %>% 
    mutate(Data = as.Date(paste0(`Mês (Código)`, "01"), format = "%Y%m%d")) %>% 
    select(Data, Valor, `Variável`) %>% 
    mutate(Data = format(Data, "%Y-%m")) %>% 
    filter(Data >= y) 
}

# Obtendo dados
IPCA <- sidra('/t/1737/n1/all/v/63,2263,2264,2265/p/all/d/v63%202,v2263%202,v2264%202,v2265%202', format(Sys.Date() - months(24), "%Y-%m")) %>% 
  pivot_wider(names_from = "Variável", values_from = "Valor")

IPCA <- arrange(IPCA, Data)
colnames(IPCA) <- c("Data", "Mensal", "3 meses", "6 meses", "12 meses")

# Criando o gráfico com highcharter
hchart(IPCA, "column", hcaes(x = Data, y = Mensal, color = ifelse(Mensal > 0, "#82C35F", "#E75A5A"))) %>%
  hc_yAxis(title = list(text = "Variação %")) %>%
  hc_legend(enabled = FALSE) %>%
  hc_colors(c("#82C35F", "#E75A5A")) %>%
  hc_plotOptions(column = list(stacking = "normal")) %>%
  hc_title(text = "") %>%
  hc_tooltip(pointFormat = "<b>{point.y:.2f}%</b>")

```

###### 3 meses

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}
# Função sidra
sidra <- function(z, y) {
  get_sidra(api = z) %>% 
    select(`Mês (Código)`, `Valor`, `Variável`) %>% 
    mutate(Data = as.Date(paste0(`Mês (Código)`, "01"), format = "%Y%m%d")) %>% 
    select(Data, Valor, `Variável`) %>% 
    mutate(Data = format(Data, "%Y-%m")) %>% 
    filter(Data >= y) 
}

# Criar dados iniciais
IPCA <- sidra('/t/1737/n1/all/v/63,2263,2264,2265/p/all/d/v63%202,v2263%202,v2264%202,v2265%202', format(Sys.Date() - months(24), "%Y-%m")) %>% 
  pivot_wider(names_from = "Variável", values_from = "Valor")

IPCA <- arrange(IPCA, desc(Data))
colnames(IPCA) <- c("Data", "Mensal", "3 meses", "6 meses", "12 meses")

hchart(IPCA, "column", hcaes(x = Data, y = `3 meses`, color = ifelse(`3 meses` > 0, "#82C35F", "#E75A5A"))) %>%
  hc_yAxis(title = list(text = "Variação %")) %>%
  hc_legend(enabled = FALSE) %>%
  hc_colors(c("#82C35F", "#E75A5A")) %>%
  hc_plotOptions(column = list(stacking = "normal")) %>%
  hc_title(text = "") %>%
  hc_tooltip(pointFormat = "<b>{point.y:.2f}%</b>")
```

###### 6 meses

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}
sidra <- function(z, y)
{
  get_sidra(api = z) %>% 
    select(`Mês (Código)`, `Valor`, `Variável`) %>% 
    mutate(Data = as.Date(paste0(`Mês (Código)`, "01"), format = "%Y%m%d")) %>% 
    select(Data, Valor, `Variável`) %>% 
    mutate(Data = format(Data, "%Y-%m")) %>% 
    filter(Data >= y) 
    }

IPCA <- sidra('/t/1737/n1/all/v/63,2263,2264,2265/p/all/d/v63%202,v2263%202,v2264%202,v2265%202', format(Sys.Date() - months(60), "%Y-%m")) %>% 
  pivot_wider(names_from = "Variável", values_from = "Valor")

IPCA <- arrange(IPCA, Data)
colnames(IPCA) <- c("Data", "Mensal", "3 meses", "6 meses", "12 meses")

IPCA_semestral <- IPCA %>% select(Data, `6 meses`) %>% 
  mutate(cor = ifelse(`6 meses`>0, "azul", "vermelho"))

IPCA_semestral$Data <- as.Date(paste0(IPCA_semestral$Data, "-01"), format = "%Y-%m-%d")

hchart(IPCA, "column", hcaes(x = Data, y = `6 meses`, color = ifelse(`6 meses` > 0, "#82C35F", "#E75A5A"))) %>%
  hc_yAxis(title = list(text = "Variação %")) %>%
  hc_legend(enabled = FALSE) %>%
  hc_colors(c("#82C35F", "#E75A5A")) %>%
  hc_plotOptions(column = list(stacking = "normal")) %>%
  hc_title(text = "") %>%
  hc_tooltip(pointFormat = "<b>{point.y:.2f}%</b>")
```

###### 12 meses 

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}
sidra <- function(z, y)
{
  get_sidra(api = z) %>% 
    select(`Mês (Código)`, `Valor`, `Variável`) %>% 
    mutate(Data = as.Date(paste0(`Mês (Código)`, "01"), format = "%Y%m%d")) %>% 
    select(Data, Valor, `Variável`) %>% 
    mutate(Data = format(Data, "%Y-%m")) %>% 
    filter(Data >= y) 
    }

IPCA <- sidra('/t/1737/n1/all/v/63,2263,2264,2265/p/all/d/v63%202,v2263%202,v2264%202,v2265%202', format(Sys.Date() - months(120), "%Y-%m")) %>% 
  pivot_wider(names_from = "Variável", values_from = "Valor")

IPCA <- arrange(IPCA, Data)
colnames(IPCA) <- c("Data", "Mensal", "3 meses", "6 meses", "12 meses")

IPCA_anual <- IPCA %>% select(Data, `12 meses`) %>% 
  mutate(cor = ifelse(`12 meses`>0, "azul", "vermelho"))

IPCA_anual$Data <- as.Date(paste0(IPCA_anual$Data, "-01"), format = "%Y-%m-%d")

hchart(IPCA, "column", hcaes(x = Data, y = `12 meses`, color = ifelse(`12 meses` > 0, "#82C35F", "#E75A5A"))) %>%
  hc_yAxis(title = list(text = "Variação %")) %>%
  hc_legend(enabled = FALSE) %>%
  hc_colors(c("#82C35F", "#E75A5A")) %>%
  hc_plotOptions(column = list(stacking = "normal")) %>%
  hc_title(text = "") %>%
  hc_tooltip(pointFormat = "<b>{point.y:.2f}%</b>")
```

##### Grupos {.tabset .tabset-fade .tabset-pills}

- Os gráficos apresentados são referentes aos grupos da cesta que é definida pela Pesquisa de Orçamentos Familiares. 
- Com estes dados é possível identificar quais grupos sofreram maiores mudanças nos níveis de preços no período analisado.

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}

grupos_box <- get_sidra(api = '/t/7060/n1/all/v/63/p/all/c315/7170,7445,7486,7558,7625,7660,7712,7766,7786/d/v63%202')


ggplot(grupos_box, aes(x = Valor, y = fct_rev(`Geral, grupo, subgrupo, item e subitem`), fill = `Geral, grupo, subgrupo, item e subitem`)) +
  geom_boxplot() +
  scale_fill_hue(direction = 1)  +
  labs(
    x = element_text("Valor", face = "bold"),
    y = element_text("Geral, grupo, subgrupo, item e subitem", face = "bold"),
    fill = "Cores"
  )  +
  ggtitle("BOXPLOT - VARIAÇÃO MENSAL DESDE JAN-2020") +
  theme_light()+
  theme(legend.position = "none")
  

```

###### Mensal

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}

grupos_mensal <- get_sidra(api = '/t/7060/n1/all/v/63/p/all/c315/7170,7445,7486,7558,7625,7660,7712,7766,7786/d/v63%202') %>%   
  mutate(
    cor = ifelse(Valor > 0, "#82C35F", "#E75A5A"),
    Mês = as.Date(paste0(Mês, "01"), format = "%Y%m%d")
  ) %>% 
  filter(`Mês (Código)` == max(`Mês (Código)`))

plot_ly(data = grupos_mensal, 
        x = ~Valor, 
        y = ~fct_rev(`Geral, grupo, subgrupo, item e subitem`), 
        type = "bar", 
        marker = list(color = ~cor)) %>% 
  layout(
    xaxis = list(title = "Valor"),
    yaxis = list(title = "Geral, grupo, subgrupo, item e subitem"),
    title = "VARIAÇÃO MENSAL",
    showlegend = FALSE
  )

```

###### Acumulada em 12 meses

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}

grupos_mensal <- get_sidra(api = '/t/7060/n1/all/v/2265/p/all/c315/7170,7445,7486,7558,7625,7660,7712,7766,7786/d/v2265%202') %>%   mutate(
    cor = ifelse(Valor > 0, "#82C35F", "#E75A5A"),
    Mês = as.Date(paste0(Mês, "01"), format = "%Y%m%d"),
    )  %>% 
  filter(`Mês (Código)` == max(`Mês (Código)`))

plot_ly(data = grupos_mensal, 
        x = ~Valor, 
        y = ~fct_rev(`Geral, grupo, subgrupo, item e subitem`), 
        type = "bar", 
        marker = list(color = ~cor)) %>% 
  layout(
    xaxis = list(title = "Valor"),
    yaxis = list(title = "Geral, grupo, subgrupo, item e subitem"),
    title = "VARIAÇÃO ACUMULADA EM 12 MESES",
    showlegend = FALSE
  )

```

###### Pesos dos grupos

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}

pesos <- get_sidra(api = '/t/7060/n1/all/v/66/p/all/c315/7170,7445,7486,7558,7625,7660,7712,7766,7786/d/v66%204') %>%   
  mutate(
    `Mês (Código)` = ymd(paste0(`Mês (Código)`, "01"))
  ) %>% 
  filter(`Mês (Código)` >= max(`Mês (Código)`) - months(6) + 1)

# Usando plot_ly para criar um gráfico de barras
plot_ly(pesos, x = ~`Mês (Código)`, y = ~Valor, type = "bar", color = ~fct_rev(`Geral, grupo, subgrupo, item e subitem`), colors = "Dark2") %>%
  layout(
    xaxis = list(title = " ", titlefont = list(size = 14, color = "black")),
    yaxis = list(title = "Pesos dos grupos", titlefont = list(size = 14, color = "black")),
    barmode = "stack",
    title = "Pesos ou participações dos grupos na cesta",
    showlegend = TRUE
  )


```

##### Localidade

#### INPC {.tabset .tabset-fade .tabset-pills}

O INPC verifica a variação do custo de vida médio apenas de famílias<span style="font-weight: bold; color: #ff6600;"> com renda mensal de 1 a 5 salários mínimos</span>. Esses grupos são mais sensíveis às variações de preços, pois tendem a gastar todo o seu rendimento em itens básicos, como alimentação, medicamentos, transporte etc

O propósito do INPC e IPCA são o mesmo: medir a variação de preços de uma cesta de produtos e serviços consumida pela população. O resultado mostra se os preços aumentaram ou diminuíram de um mês para o outro.

A cesta de ambos é definida pela [Pesquisa de Orçamentos Familiares](https://www.ibge.gov.br/estatisticas/sociais/populacao/24786-pesquisa-de-orcamentos-familiares-2.html?utm_source=landing&utm_medium=explica&utm_campaign=inflacao) - POF, do IBGE, que, entre outras questões, verifica o que a população consome e quanto do rendimento familiar é gasto em cada produto: arroz, feijão, passagem de ônibus, material escolar, médico, cinema, entre outros.

Os índices, portanto, levam em conta não apenas a variação de preço de cada item, mas também o peso que ele tem no orçamento das famílias.

[Tabela 7063](https://sidra.ibge.gov.br/tabela/7063)

##### Índice {.tabset .tabset-fade .tabset-pills}

```{r echo=FALSE, warning=FALSE, message=FALSE}

sidra <- function(z, y)
{
  get_sidra(api = z) %>% 
    select(`Mês (Código)`, `Valor`, `Variável`) %>% 
    mutate(Data = as.Date(paste0(`Mês (Código)`, "01"), format = "%Y%m%d")) %>% 
    select(Data, Valor, `Variável`) %>% 
    mutate(Data = format(Data, "%Y-%m")) %>% 
    filter(Data >= y) 
    }

IPCA <- sidra('/t/7063/n1/all/v/44/p/all/c315/7169/d/v44%202', format(Sys.Date() - months(120), "%Y-%m")) %>% 
  pivot_wider(names_from = "Variável", values_from = "Valor")

IPCA <- arrange(IPCA, desc(Data))
colnames(IPCA) <- c("Data", "Mensal", "3 meses", "6 meses", "12 meses")

datatable(IPCA, options = list(pageLength = 10, autoWidth = TRUE, columnDefs = list(list(className = 'dt-center', targets = '_all'))), caption = "VARIAÇÃO MENSAL E ACUMULADA")


```

###### Mensal

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}

sidra <- function(z, y) {
  get_sidra(api = z) %>% 
    select(`Mês (Código)`, `Valor`, `Variável`) %>% 
    mutate(Data = as.Date(paste0(`Mês (Código)`, "01"), format = "%Y%m%d")) %>% 
    select(Data, Valor, `Variável`) %>% 
    mutate(Data = format(Data, "%Y-%m")) %>% 
    filter(Data >= y) 
}

# Obtendo dados
IPCA <- sidra('/t/7063/n1/all/v/44/p/all/c315/7169/d/v44%202', format(Sys.Date() - months(24), "%Y-%m")) %>% 
  pivot_wider(names_from = "Variável", values_from = "Valor")

IPCA <- arrange(IPCA, Data)
colnames(IPCA) <- c("Data", "Mensal", "3 meses", "6 meses", "12 meses")

# Criando o gráfico com highcharter
hchart(IPCA, "column", hcaes(x = Data, y = Mensal, color = ifelse(Mensal > 0, "#82C35F", "#E75A5A"))) %>%
  hc_yAxis(title = list(text = "Variação %")) %>%
  hc_legend(enabled = FALSE) %>%
  hc_colors(c("#82C35F", "#E75A5A")) %>%
  hc_plotOptions(column = list(stacking = "normal")) %>%
  hc_title(text = "") %>%
  hc_tooltip(pointFormat = "<b>{point.y:.2f}%</b>")

```

###### 12 meses 

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}
sidra <- function(z, y)
{
  get_sidra(api = z) %>% 
    select(`Mês (Código)`, `Valor`, `Variável`) %>% 
    mutate(Data = as.Date(paste0(`Mês (Código)`, "01"), format = "%Y%m%d")) %>% 
    select(Data, Valor, `Variável`) %>% 
    mutate(Data = format(Data, "%Y-%m")) %>% 
    filter(Data >= y) 
    }

IPCA <- sidra('/t/7063/n1/all/v/2292/p/all/c315/7169/d/v2292%202', "2020-12") %>% 
  pivot_wider(names_from = "Variável", values_from = "Valor")

IPCA <- arrange(IPCA, Data)
colnames(IPCA) <- c("Data", "12 meses")

IPCA_anual <- IPCA %>% select(Data, `12 meses`) %>% 
  mutate(cor = ifelse(`12 meses`>0, "azul", "vermelho"))

IPCA_anual$Data <- as.Date(paste0(IPCA_anual$Data, "-01"), format = "%Y-%m-%d")

hchart(IPCA, "column", hcaes(x = Data, y = `12 meses`, color = ifelse(`12 meses` > 0, "#82C35F", "#E75A5A"))) %>%
  hc_yAxis(title = list(text = "Variação %")) %>%
  hc_legend(enabled = FALSE) %>%
  hc_colors(c("#82C35F", "#E75A5A")) %>%
  hc_plotOptions(column = list(stacking = "normal")) %>%
  hc_title(text = "") %>%
  hc_tooltip(pointFormat = "<b>{point.y:.2f}%</b>")
```

##### Grupos {.tabset .tabset-fade .tabset-pills}

- Os gráficos apresentados são referentes aos grupos da cesta que é definida pela Pesquisa de Orçamentos Familiares. 
- Com estes dados é possível identificar quais grupos sofreram maiores mudanças nos níveis de preços no período analisado.

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}

grupos_box <- get_sidra(api = '/t/7063/n1/all/v/44/p/all/c315/7170,7445,7486,7558,7625,7660,7712,7766,7786/d/v44%202')


ggplot(grupos_box, aes(x = Valor, y = fct_rev(`Geral, grupo, subgrupo, item e subitem`), fill = `Geral, grupo, subgrupo, item e subitem`)) +
  geom_boxplot() +
  scale_fill_hue(direction = 1)  +
  labs(
    x = element_text("Valor", face = "bold"),
    y = element_text("Geral, grupo, subgrupo, item e subitem", face = "bold"),
    fill = "Cores"
  )  +
  ggtitle("BOXPLOT - VARIAÇÃO MENSAL DESDE JAN-2020") +
  theme_light()+
  theme(legend.position = "none")
  

```

###### Mensal

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}

grupos_mensal <- get_sidra(api = '/t/7063/n1/all/v/44/p/all/c315/7170,7445,7486,7558,7625,7660,7712,7766,7786/d/v44%202') %>%   
  mutate(
    cor = ifelse(Valor > 0, "#82C35F", "#E75A5A"),
    Mês = as.Date(paste0(Mês, "01"), format = "%Y%m%d")
  ) %>% 
  filter(`Mês (Código)` == max(`Mês (Código)`))

plot_ly(data = grupos_mensal, 
        x = ~Valor, 
        y = ~fct_rev(`Geral, grupo, subgrupo, item e subitem`), 
        type = "bar", 
        marker = list(color = ~cor)) %>% 
  layout(
    xaxis = list(title = "Valor"),
    yaxis = list(title = "Geral, grupo, subgrupo, item e subitem"),
    title = "VARIAÇÃO MENSAL",
    showlegend = FALSE
  )

```

###### Acumulada em 12 meses

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}

grupos_mensal <- get_sidra(api = '/t/7063/n1/all/v/2292/p/all/c315/7170,7445,7486,7558,7625,7660,7712,7766,7786/d/v2292%202') %>%   mutate(
    cor = ifelse(Valor > 0, "#82C35F", "#E75A5A"),
    Mês = as.Date(paste0(Mês, "01"), format = "%Y%m%d"),
    )  %>% 
  filter(`Mês (Código)` == max(`Mês (Código)`))

plot_ly(data = grupos_mensal, 
        x = ~Valor, 
        y = ~fct_rev(`Geral, grupo, subgrupo, item e subitem`), 
        type = "bar", 
        marker = list(color = ~cor)) %>% 
  layout(
    xaxis = list(title = "Valor"),
    yaxis = list(title = "Geral, grupo, subgrupo, item e subitem"),
    title = "VARIAÇÃO ACUMULADA EM 12 MESES",
    showlegend = FALSE
  )

```

###### Pesos dos grupos

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}

pesos <- get_sidra(api = '/t/7063/n1/all/v/45/p/all/c315/7170,7445,7486,7558,7625,7660,7712,7766,7786/d/v45%204') %>%   
  mutate(
    `Mês (Código)` = ymd(paste0(`Mês (Código)`, "01"))
  ) %>% 
  filter(`Mês (Código)` >= max(`Mês (Código)`) - months(6) + 1)

# Usando plot_ly para criar um gráfico de barras
plot_ly(pesos, x = ~`Mês (Código)`, y = ~Valor, type = "bar", color = ~fct_rev(`Geral, grupo, subgrupo, item e subitem`), colors = "Dark2") %>%
  layout(
    xaxis = list(title = " ", titlefont = list(size = 14, color = "black")),
    yaxis = list(title = "Pesos dos grupos", titlefont = list(size = 14, color = "black")),
    barmode = "stack",
    title = "Pesos ou participações dos grupos na cesta",
    showlegend = TRUE
  )


```

##### Localidade


#### IPGM

O ig..

```{r echo=FALSE, warning=FALSE, message=FALSE}

IPGM <- GetBCBData::gbcbd_get_series(
id = 189,
first.date = "1989-01-01",
last.date = Sys.Date()
)


```

### Juros

selic

### Estoque

m1

### B. pagamentos

tabela dos saldos

## GOVERNO 

### Defict fiscal

### Emissão de dívidas

## MERCADO NACIONAL  

### CAGED

### PNAD

### PMC {.tabset .tabset-fade .tabset-pills}

A Pesquisa Mensal do Comércio - PMC é uma pesquisa por amostragem probabilística, realizada em todas as Unidades da Federação.

O objetivo contemplado no desenho da amostra é a obtenção de estimativas dos totais populacionais referentes à variável receita bruta de revenda, por Unidade da Federação e por atividade PMC, utilizadas para construir os indicadores da pesquisa que são divulgados mensalmente. A unidade de investigação da PMC é a empresa, sendo também a unidade amostral, ou seja, a unidade utilizada para a seleção e expansão da amostra.

As séries da PMC ajustadas sazonalmente consideram como fatores sazonais, o efeito calendário, os feriados de Carnaval, Páscoa e Corpus Christi além da identificação de outliers. Os cálculos são feitos utilizando-se o software X12 ARIMA, do U.S. Census Bureau.

#### COMÉRCIO VAREJISTA {.tabset .tabset-fade .tabset-pills}

- Refere-se à venda de bens e serviços diretamente ao consumidor final para uso pessoal ou doméstico.
- Inclui uma ampla gama de atividades, desde a venda de alimentos e vestuário até produtos eletrônicos, móveis e combustíveis, entre outros.
- As atividades do comércio varejista são monitoradas para avaliar a demanda do consumidor e a saúde geral da economia.

[Tabela 8880](https://sidra.ibge.gov.br/tabela/8880)

##### RECEITA

```{r echo = FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}

sidra <- function(z, y)
{
  get_sidra(api = z) %>% 
    select(`Mês (Código)`, `Valor`) %>% 
    mutate(Data = as.Date(paste0(`Mês (Código)`, "01"), format = "%Y%m%d")) %>% 
    select(Data, Valor) %>% 
    mutate(Data = format(Data, "%Y-%m")) %>% 
    filter(Data >= y) 
    }

# Capturando os dados e tratando
PMC = sidra('/t/8880/n1/all/v/7169/p/all/c11046/56733/d/v7169%205', format(Sys.Date() - months(26), "%Y-%m")) %>% 
  rename(PMC = Valor) %>% 
  mutate(PMC_MENSAL = ((PMC / lag(PMC)-1) * 100 )) %>% 
  mutate(Cor = ifelse(PMC_MENSAL > 0, "#82C35F", "#E75A5A")) %>% 
  filter(Data >= format(Sys.Date() - months(25), "%Y-%m"))

#Plotando
hchart(PMC, "column", hcaes(x = Data, y = PMC_MENSAL, color = ifelse(PMC_MENSAL > 0, "#82C35F", "#E75A5A"))) %>%
  hc_yAxis(title = list(text = "Variação %")) %>%
  hc_legend(enabled = FALSE) %>%
  hc_colors(c("#82C35F", "#E75A5A")) %>%
  hc_plotOptions(column = list(stacking = "normal")) %>%
  hc_title(text = "") %>%
  hc_tooltip(pointFormat = "<b>{point.y:.2f}%</b>")

```

##### VOLUME

```{r echo = FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}

sidra <- function(z, y)
{
  get_sidra(api = z) %>% 
    select(`Mês (Código)`, `Valor`) %>% 
    mutate(Data = as.Date(paste0(`Mês (Código)`, "01"), format = "%Y%m%d")) %>% 
    select(Data, Valor) %>% 
    mutate(Data = format(Data, "%Y-%m")) %>% 
    filter(Data >= y) 
    }

#Capoturando e tratando dados
PMC = sidra('/t/8880/n1/all/v/7169/p/all/c11046/56734/d/v7169%205', format(Sys.Date() - months(26), "%Y-%m")) %>% 
  rename(PMC = Valor) %>% 
  mutate(PMC_MENSAL = ((PMC / lag(PMC)-1) * 100 )) %>% 
  mutate(Cor = ifelse(PMC_MENSAL > 0, "#82C35F", "#E75A5A")) %>% 
  filter(Data >= format(Sys.Date() - months(25), "%Y-%m"))

#protando resultado
hchart(PMC, "column", hcaes(x = Data, y = PMC_MENSAL, color = ifelse(PMC_MENSAL > 0, "#82C35F", "#E75A5A"))) %>%
  hc_yAxis(title = list(text = "Variação %")) %>%
  hc_legend(enabled = FALSE) %>%
  hc_colors(c("#82C35F", "#E75A5A")) %>%
  hc_plotOptions(column = list(stacking = "normal")) %>%
  hc_title(text = "") %>%
  hc_tooltip(pointFormat = "<b>{point.y:.2f}%</b>")

```

#### COMÉRCIO VAREJISTA AMPLIADO {.tabset .tabset-fade .tabset-pills}

- Inclui todas as atividades do comércio varejista, mas vai além ao incorporar categorias adicionais relacionadas ao varejo.
- Normalmente, o comércio varejista ampliado pode incluir a venda de veículos, motocicletas, partes e peças; material de construção; e equipamentos e materiais para escritório, informática e comunicação, entre outros.
- Essa categoria é mais abrangente e oferece uma visão mais ampla do ambiente de varejo, incorporando setores que podem não estar diretamente relacionados ao consumo pessoal diário.

[Tabela 8881](https://sidra.ibge.gov.br/tabela/8881)

##### RECEITA

```{r echo = FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}

sidra <- function(z, y)
{
  get_sidra(api = z) %>% 
    select(`Mês (Código)`, `Valor`) %>% 
    mutate(Data = as.Date(paste0(`Mês (Código)`, "01"), format = "%Y%m%d")) %>% 
    select(Data, Valor) %>% 
    mutate(Data = format(Data, "%Y-%m")) %>% 
    filter(Data >= y) 
    }

PMC = sidra('/t/8881/n1/all/v/7169/p/all/c11046/56735/d/v7169%205', format(Sys.Date() - months(26), "%Y-%m")) %>% 
  rename(PMC = Valor) %>% 
  mutate(PMC_MENSAL = ((PMC / lag(PMC)-1) * 100 )) %>% 
  mutate(Cor = ifelse(PMC_MENSAL > 0, "#82C35F", "#E75A5A")) %>% 
  filter(Data >= format(Sys.Date() - months(25), "%Y-%m"))

#Plotando
hchart(PMC, "column", hcaes(x = Data, y = PMC_MENSAL, color = ifelse(PMC_MENSAL > 0, "#82C35F", "#E75A5A"))) %>%
  hc_yAxis(title = list(text = "Variação %")) %>%
  hc_legend(enabled = FALSE) %>%
  hc_colors(c("#82C35F", "#E75A5A")) %>%
  hc_plotOptions(column = list(stacking = "normal")) %>%
  hc_title(text = "") %>%
  hc_tooltip(pointFormat = "<b>{point.y:.2f}%</b>")
```

##### VOLUME

```{r echo = FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}

sidra <- function(z, y)
{
  get_sidra(api = z) %>% 
    select(`Mês (Código)`, `Valor`) %>% 
    mutate(Data = as.Date(paste0(`Mês (Código)`, "01"), format = "%Y%m%d")) %>% 
    select(Data, Valor) %>% 
    mutate(Data = format(Data, "%Y-%m")) %>% 
    filter(Data >= y) 
    }

PMC = sidra('/t/8881/n1/all/v/7169/p/all/c11046/56736/d/v7169%205', format(Sys.Date() - months(26), "%Y-%m")) %>% 
  rename(PMC = Valor) %>% 
  mutate(PMC_MENSAL = ((PMC / lag(PMC)-1) * 100 )) %>% 
  mutate(Cor = ifelse(PMC_MENSAL > 0, "#82C35F", "#E75A5A")) %>% 
  filter(Data >= format(Sys.Date() - months(25), "%Y-%m"))

#Protando gráfico
hchart(PMC, "column", hcaes(x = Data, y = PMC_MENSAL, color = ifelse(PMC_MENSAL > 0, "#82C35F", "#E75A5A"))) %>%
  hc_yAxis(title = list(text = "Variação %")) %>%
  hc_legend(enabled = FALSE) %>%
  hc_colors(c("#82C35F", "#E75A5A")) %>%
  hc_plotOptions(column = list(stacking = "normal")) %>%
  hc_title(text = "") %>%
  hc_tooltip(pointFormat = "<b>{point.y:.2f}%</b>")

```

### PMS {.tabset .tabset-fade .tabset-pills}

A Pesquisa Mensal de Serviços - PMS tem como objetivo produzir indicadores que permitam acompanhar o comportamento conjuntural dos principais segmentos empresariais não-financeiros do setor de serviços, excluindo-se os da saúde e da educação, complementando, através da análise de curto prazo, o mapeamento da estrutura das atividades de serviços no País, efetuado pela Pesquisa Anual de Serviços - PAS. 

[Tabela 5906](https://sidra.ibge.gov.br/tabela/5906)

#### RECEITA

```{r echo = FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}
sidra <- function(z, y)
{
  get_sidra(api = z) %>% 
    select(`Mês (Código)`, `Valor`) %>% 
    mutate(Data = as.Date(paste0(`Mês (Código)`, "01"), format = "%Y%m%d")) %>% 
    select(Data, Valor) %>% 
    mutate(Data = format(Data, "%Y-%m")) %>% 
    filter(Data >= y) 
    }

PMS = sidra('/t/5906/n1/all/v/7167/p/all/c11046/56725/d/v7167%205', format(Sys.Date() - months(26), "%Y-%m")) %>% 
  rename(PMS = Valor) %>% 
  mutate(PMS_MENSAL = ((PMS / lag(PMS)-1) * 100 )) %>% 
  mutate(Cor = ifelse(PMS_MENSAL > 0, "#82C35F", "#E75A5A"))%>% 
  filter(Data >= format(Sys.Date() - months(25), "%Y-%m"))

hchart(PMS, "column", hcaes(x = Data, y = PMS_MENSAL, color = ifelse(PMS_MENSAL > 0, "#82C35F", "#E75A5A"))) %>%
  hc_yAxis(title = list(text = "Variação %")) %>%
  hc_legend(enabled = FALSE) %>%
  hc_colors(c("#82C35F", "#E75A5A")) %>%
  hc_plotOptions(column = list(stacking = "normal")) %>%
  hc_title(text = "") %>%
  hc_tooltip(pointFormat = "<b>{point.y:.2f}%</b>")

```

#### VOLUME

```{r echo = FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8}
sidra <- function(z, y)
{
  get_sidra(api = z) %>% 
    select(`Mês (Código)`, `Valor`) %>% 
    mutate(Data = as.Date(paste0(`Mês (Código)`, "01"), format = "%Y%m%d")) %>% 
    select(Data, Valor) %>% 
    mutate(Data = format(Data, "%Y-%m")) %>% 
    filter(Data >= y) 
    }

PMS = sidra('/t/5906/n1/all/v/7167/p/all/c11046/56726/d/v7167%205', format(Sys.Date() - months(26), "%Y-%m")) %>% 
  rename(PMS = Valor) %>% 
  mutate(PMS_MENSAL = ((PMS / lag(PMS)-1) * 100 )) %>% 
  mutate(Cor = ifelse(PMS_MENSAL > 0, "#82C35F", "#E75A5A"))%>% 
  filter(Data >= format(Sys.Date() - months(25), "%Y-%m"))

hchart(PMS, "column", hcaes(x = Data, y = PMS_MENSAL, color = ifelse(PMS_MENSAL > 0, "#82C35F", "#E75A5A"))) %>%
  hc_yAxis(title = list(text = "Variação %")) %>%
  hc_legend(enabled = FALSE) %>%
  hc_colors(c("#82C35F", "#E75A5A")) %>%
  hc_plotOptions(column = list(stacking = "normal")) %>%
  hc_title(text = "") %>%
  hc_tooltip(pointFormat = "<b>{point.y:.2f}%</b>")

```

### PMI 

### Cielo

### Carros

